-- V47: Remove Machine Learning operators from the system
-- Note: PostgreSQL does not support removing enum values directly.
-- This migration disables any rules using ML operators and documents the removal.

-- Disable any rules that use ML operators (they should already be disabled)
UPDATE rule_conditions 
SET enabled = false 
WHERE operator IN (
    'LLM_TRANSACTION_DESCRIPTION_ANALYSIS',
    'LLM_GENERATIVE_RULE_SYNTHESIS',
    'LLM_ANOMALY_EXPLANATION_GENERATION',
    'LLM_CHATBOT_FRAUD_DETECTION',
    'LLM_DEEPFAKE_VOICE_DETECTION',
    'LLM_SYNTHETIC_IMAGE_DETECTION',
    'LLM_EMAIL_PHISHING_ANALYSIS',
    'LLM_SOCIAL_ENGINEERING_CLASSIFICATION',
    'LLM_FRAUD_ALERT_PRIORITIZATION',
    'LLM_MULTI_MODAL_FRAUD_DETECTION',
    'LLM_ADVERSARIAL_ATTACK_RESISTANCE',
    'LLM_FRAUD_PATTERN_AUTODISCOVERY',
    'STAT_KRUSKAL_WALLIS_TEST',
    'STAT_ANOVA_F_TEST',
    'STAT_ISOLATION_FOREST_SCORE',
    'STAT_LOCAL_OUTLIER_FACTOR',
    'STAT_ONE_CLASS_SVM_BOUNDARY',
    'STAT_KMEANS_CLUSTER_DISTANCE',
    'STAT_DBSCAN_NOISE_DETECTION',
    'STAT_GMM_PROBABILITY',
    'STAT_MAHALANOBIS_DISTANCE',
    'STAT_GRUBBS_TEST',
    'STAT_DIXON_Q_TEST',
    'STAT_SHAPIRO_WILK_TEST',
    'STAT_LEVENE_TEST',
    'STAT_WELCH_T_TEST',
    'STAT_BOOTSTRAP_CONFIDENCE_INTERVAL',
    'BIOMETRIC_KEYSTROKE_DYNAMICS',
    'BIOMETRIC_MOUSE_MOVEMENT',
    'BIOMETRIC_SCROLL_VELOCITY',
    'DEVICE_FINGERPRINT_CONSISTENCY_CHECK',
    'ECBSV_SSN_VALIDATION',
    'SYNTHETIC_FRAUD_SCORE',
    'INJECTION_ATTACK_DETECTION',
    'LIVENESS_DETECTION_FACIAL',
    'LIVENESS_DETECTION_VOICE',
    'ANTI_DETECT_BROWSER_DETECTION',
    'DOCUMENT_FORGERY_DETECTION',
    'FACE_TO_ID_PHOTO_MATCHING',
    'ADAPTIVE_BEHAVIORAL_ANALYTICS',
    'SYNTHETIC_ID_LABEL_CORRECTION',
    'MULTI_LAYERED_SYNTHETIC_ID_CONTROLS',
    'CARD_TESTING_RING_DETECTION',
    'BUST_OUT_PATTERN_DETECTION',
    'CIRCULAR_PAYMENT_DETECTION',
    'ACCOUNT_TAKEOVER_PATTERN',
    'SYNTHETIC_IDENTITY_RING',
    'CROSS_BORDER_VELOCITY',
    'CORRESPONDENT_ANOMALY',
    'NESTED_CORRESPONDENT_CHECK',
    'SHELL_BANK_INDICATOR',
    'HIGH_RISK_CORRIDOR_CHECK',
    'SEGMENT_OF_ONE_PROFILING',
    'ADAPTIVE_PARAMETRIC_THRESHOLD',
    'REAL_TIME_RISK_SCORING',
    'CONSORTIUM_NEGATIVE_FILE_CHECK',
    'PEER_GROUP_DEVIATION_SCORE',
    'MICRO_DEPOSIT_VELOCITY',
    'RAPID_SUCCESSION_PATTERN',
    'SPLIT_TRANSACTION_DETECTION',
    'ROUND_TRIP_DETECTION',
    'LAYERED_TRANSFER_PATTERN',
    'APP_FRAUD_DETECTION',
    'ROMANCE_SCAM_INDICATOR',
    'INVESTMENT_SCAM_PATTERN',
    'CRYPTO_PUMP_DUMP_DETECTION',
    'PIG_BUTCHERING_INDICATOR'
);

-- Add comment documenting the removal
COMMENT ON TYPE condition_operator IS 'ML operators (LLM_*, STAT_ISOLATION_*, BIOMETRIC_*, etc.) were removed in V47. These enum values still exist in PostgreSQL but are no longer supported by the application.';
